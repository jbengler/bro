---
title: "Heatmaps"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Heatmaps}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
########### bro heatmap function

library(tidyverse)
library(bro)

bro_plot_heatmap(bro_data_exprs,
                 rows = external_gene_name,
                 columns = sample,
                 values = expression
)

bro_plot_heatmap(bro_data_exprs,
                 rows = external_gene_name,
                 columns = sample,
                 values = expression,
                 scale = "row"
)

bro_plot_heatmap(bro_data_exprs,
                 rows = external_gene_name,
                 columns = sample,
                 values = expression,
                 scale = "row",
                 color_scale_n = 16,
                 color_scale_min = -2,
                 color_scale_max = 2
)

bro_plot_heatmap(bro_data_exprs,
                 rows = external_gene_name,
                 columns = sample,
                 values = expression,
                 ann_col = c(sample_type, condition, group),
                 ann_row = c(is_immune_gene, direction),
                 scale = "row",
                 color_scale_n = 16,
                 color_scale_min = -2,
                 color_scale_max = 2
)

ann_colors <- list(
  condition = c(EAE = "#BD79B4", healthy = "#F5CEF2"),
  group = c(Ein = "#C14236", Eip = "#E28946", Hin = "#4978AB", Hip = "#98BB85"),
  sample_type = c(input = "#BDBDBD", IP = "#7D7D7D"),
  direction = c(down = "#5071DC", up = "#C34B6B"),
  is_immune_gene = c(yes = "#B69340", no = "#FFFFFF")
)

bro_plot_heatmap(bro_data_exprs,
                 rows = external_gene_name,
                 columns = sample,
                 values = expression,
                 ann_col = c(sample_type, condition, group),
                 ann_row = c(direction, is_immune_gene),
                 scale = "row",
                 color_scale_n = 16,
                 color_scale_min = -2,
                 color_scale_max = 2,
                 ann_colors = ann_colors
)

bro_plot_heatmap(bro_data_exprs,
                 rows = external_gene_name,
                 columns = sample,
                 values = expression,
                 ann_col = c(sample_type, condition, group),
                 ann_row = c(direction, is_immune_gene),
                 scale = "row",
                 color_scale_n = 16,
                 color_scale_min = -2,
                 color_scale_max = 2,
                 ann_colors = ann_colors,
                 gaps_row = direction,
                 gaps_col = sample_type
)

bro_plot_heatmap(bro_data_exprs,
                 rows = external_gene_name,
                 columns = sample,
                 values = expression,
                 ann_col = c(sample_type, condition, group),
                 ann_row = c(direction, is_immune_gene),
                 scale = "row",
                 color_scale_n = 16,
                 color_scale_min = -2,
                 color_scale_max = 2,
                 ann_colors = ann_colors,
                 gaps_row = direction,
                 gaps_col = group
)

bro_plot_heatmap(bro_data_exprs,
                 rows = external_gene_name,
                 columns = sample,
                 values = expression,
                 ann_col = c(sample_type, condition, group),
                 ann_row = c(direction, is_immune_gene),
                 gaps_row = direction,
                 gaps_col = group,
                 return_data = TRUE
)

```

